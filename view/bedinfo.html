<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>床位信息</title>
    <link rel="stylesheet" href="../lib/layui-v2.6.3/css/layui.css" media="all">
    <link rel="stylesheet" href="../css/public.css" media="all">
    <style>
        .layui-btn:not(.layui-btn-lg ):not(.layui-btn-sm):not(.layui-btn-xs) {
            height: 34px;
            line-height: 34px;
            padding: 0 8px;
        }
    </style>
</head>
<body>
    <div class="layuimini-container">
        <div class="layuimini-main">
            <blockquote class="layui-elem-quote">
                床位列表<br>
            </blockquote>
            <div>
                <!--<div class="layui-btn-group">
                    <button class="layui-btn" id="btn-expand">全部展开</button>
                    <button class="layui-btn layui-btn-normal" id="btn-fold">全部折叠</button>
                    <button type="button" class="layui-btn layui-btn-primary" id="test-page-title">剔除默认标题栏</button>
                </div>-->
                <table id="munu-table" class="layui-table" lay-filter="munu-table"></table>
            </div>
        </div>
    </div>
    <!-- 操作列 -->
    <script type="text/html" id="auth-state">
        <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="edit">修改</a>
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
    </script>
    <script type="text/html" id="sexTpl">
        {{#  if(d.sex_name === '女'){ }}
        <span style="color: #F581B1;">{{ d.sex_name }}</span>
        {{#  } else { }}
        <span style="color: dodgerblue;">
            {{ d.sex_name }}
        </span>
        {{#  } }}
    </script>
    <script type="text/html" id="statusTpl">
        {{#  if(d.admiss_status_name === '常规'){ }}
        <span style="color: green;">{{ d.admiss_status_name }}</span>
        {{#  } else if(d.admiss_status_name === '危'){ }}
        <span style="color: red;">{{ d.admiss_status_name }}</span>
        {{#  } else if(d.admiss_status_name === '急'){ }}
        <span style="color: purple;">{{ d.admiss_status_name }}</span>
        {{#  } else if(d.admiss_status_name === '重'){ }}
        <span style="color: blue;">{{ d.admiss_status_name }}</span>
        {{#  } else { }}
        <!--{ d.admiss_status_name }}-->
        {{#  } }}
    </script>
    <script src="../lib/layui-v2.6.3/layui.js" charset="utf-8"></script>
    <script src="../js/lay-config.js?v=1.0.4" charset="utf-8"></script>
    <script>
layui.use(['table', 'treetable'], function () {
            var $ = layui.jquery;
            var table = layui.table;
            var treetable = layui.treetable;

            // 渲染表格
            var table = layui.table;

            // 渲染
            table.render({
                elem: '#munu-table',
                url: 'http://10.102.38.249:5105/api/MobileWard/GetActPatientLists?ward=' + localStorage.ward_sn + '&inout=I',
                page: true,
                response: {
                    statusCode: 1 // 重新规定成功的状态码为 1，table 组件默认为 0
                },
                // 将原始数据解析成 table 组件所规定的数据格式
                parseData: function (res) {
                    return {
                        "code": res.status, //解析接口状态
                        "msg": res.message, //解析提示文本
                        "count": res.total, //解析数据长度
                        "data": res.data //解析数据列表
                    };
                },
                cellMinWidth: 60,
                cols: [[
                    { field: 'inpatient_no', title: '住院号', sort: true },// unresize: true,
                    { field: 'bed_no', title: '床号', sort: true },
                    { field: 'name', title: '姓名' },
                    { field: 'sex_name', title: '性别', templet: '#sexTpl'},
                    { field: 'ages', title: '年龄' },
                    { field: 'admiss_date', title: '入院时间' },
                    { field: 'responce_type_name', title: '身份' },
                    { field: 'refer_physician_name', title: '管床医生' },
                    { field: 'refer_nurse_name', title: '管床护士' },
                    { field: 'admiss_status_name', title: '状态', templet: '#statusTpl' },
                    { field: 'nursing', title: '护理级别' }
                ]],
                //height: 315

            });

            $('#btn-expand').click(function () {
                treetable.expandAll('#munu-table');
            });

            $('#btn-fold').click(function () {
                treetable.foldAll('#munu-table');
            });

            $('#test-page-title').click(function () {
                window.parent.layui.layer.open({
                    type: 2,
                    //  maxmin : true,
                    area: ['100%', '100%'],
                    //title: false, // 不显示标题栏
                    title: "体温单", // 不显示标题栏
                    closeBtn: 1,
                    shadeClose: true, // 点击遮罩关闭层
                    //content: '<div style="padding: 16px;">任意 HTML 内容。可点击遮罩区域关闭。</div>'
                    content: 'http://10.102.38.249:8001/?patient_id=000274176000&admiss_times=1&api_host=http://10.102.38.249:5105/' //这里content是一个URL，如果你不想让iframe出现滚动条，你还可以content: ['http://sentsin.com', 'no']

                });


                ////新增一个Tab项
                //  window.parent.layui.element.tabAdd('demo', {
                //   title: '新选项'+ (Math.random()*1000|0) //用于演示
                //   ,content: '内容'+ (Math.random()*1000|0)
                //   ,id: new Date().getTime() //实际使用一般是规定好的id，这里以时间戳模拟下
                // })
            });


            //监听工具条
            table.on('tool(munu-table)', function (obj) {
                var data = obj.data;
                var layEvent = obj.event;

                if (layEvent === 'del') {
                    layer.msg('删除' + data.id);
                } else if (layEvent === 'edit') {
                    layer.msg('修改' + data.id);
                }
            });
});
    </script>
</body>
</html>