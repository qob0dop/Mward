<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>病区选择</title>
    <!--<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">-->
    <link rel="stylesheet" href="../lib/layui-v2.6.3/css/layui.css" media="all">
    <link rel="stylesheet" href="../css/public.css" media="all">
    <style>
        .layui-btn:not(.layui-btn-lg ):not(.layui-btn-sm):not(.layui-btn-xs) {
            height: 34px;
            line-height: 34px;
            padding: 0 8px;
        }
        .layui-elem-quote {
            padding: 8px;
            margin-bottom: 0;
            font-weight: bold;
            line-height: 1.1;
            font-size: 1.1rem;
        }
        .layui-table, .layui-table-view {
            margin: 3px 0;
        } 
    </style>
</head>
<body>
    <div class="layuimini-container">
        <div class="layuimini-main">
            <blockquote class="layui-elem-quote">
                病区选择<br>
            </blockquote>
            <div>
                <!--<div class="layui-btn-group">
                    <button class="layui-btn" id="btn-expand">全部展开</button>
                    <button class="layui-btn layui-btn-normal" id="btn-fold">全部折叠</button>
                    <button type="button" class="layui-btn layui-btn-primary" id="test-page-title">剔除默认标题栏</button>
                </div>-->
                <table id="munu-table" class="layui-table" lay-filter="munu-table"></table>
            </div>
        </div>
    </div>
    <!-- 操作列 -->
    <script type="text/html" id="auth-state">
        <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="edit">修改</a>
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
    </script>
    <script type="text/html" id="sexTpl">
        {{#  if(d.sex_name === '女'){ }}
        <span style="color: #F581B1;">{{ d.sex_name }}</span>
        {{#  } else { }}
        <span style="color: dodgerblue;">
            {{ d.sex_name }}
        </span>
        {{#  } }}
    </script>
    <script type="text/html" id="statusTpl">
        {{#  if(d.admiss_status_name === '常规'){ }}
        <span style="color: green;">{{ d.admiss_status_name }}</span>
        {{#  } else if(d.admiss_status_name === '危'){ }}
        <span style="color: red;">{{ d.admiss_status_name }}</span>
        {{#  } else if(d.admiss_status_name === '急'){ }}
        <span style="color: purple;">{{ d.admiss_status_name }}</span>
        {{#  } else if(d.admiss_status_name === '重'){ }}
        <span style="color: blue;">{{ d.admiss_status_name }}</span>
        {{#  } else { }}
        <!--{ d.admiss_status_name }}-->
        {{#  } }}
    </script>
    <script src="../lib/layui-v2.6.3/layui.js" charset="utf-8"></script>
    <script src="../js/lay-config.js?v=1.0.4" charset="utf-8"></script>
    <script>
layui.use(['table', 'treetable', 'appconfig'], function () {
            var $ = layui.jquery;
            var table = layui.table;
            var appconfig = layui.appconfig;
            var treetable = layui.treetable;

            // 渲染表格
            var table = layui.table;

            var loginUser = localStorage.getItem('loginUser');

            if (loginUser === null) {
                location.href = "login.html";
                return;
            }
            var loginUserData = JSON.parse(loginUser);

            // 渲染
            table.render({
                elem: '#munu-table',
                url: appconfig.api + "/api/ActPatient/GetYzUnitList?usermi=" + loginUserData.user_mi + "&subsys_id=yz",  //   获取控制器URL地址
                // page: true,
                response: {
                    statusCode: 1 // 重新规定成功的状态码为 1，table 组件默认为 0
                },
                // 将原始数据解析成 table 组件所规定的数据格式
                parseData: function (res) {
                    return {
                        "code": res.status, //解析接口状态
                        "msg": res.message, //解析提示文本
                        "count": res.total, //解析数据长度
                        "data": res.data //解析数据列表
                    };
                },
                cellMinWidth: 60,
                cols: [[
                    { field: 'ward_sn', title: '病区编号', width: 300, sort: true },// unresize: true,
                    { field: 'ward_name', title: '病区名称', sort: true }
                ]],
                height: screen.height - 80

            });
            //行单击事件（双击事件为：rowDouble）
            table.on('row(munu-table)', function (obj) {
                var data = obj.data;

                //layer.alert(JSON.stringify(data), {
                //    title: '当前行数据：'
                //});
                localStorage.setItem('wardData', JSON.stringify(data));

                const now = new Date();
                const ticks = now.getTime();
                //console.log(ticks);
                location.href = "/index.html" + "?ticks=" + ticks;

                //标注选中样式
                //obj.tr.addClass('layui-table-click').siblings().removeClass('layui-table-click');
            });
            //监听工具条
            table.on('tool(munu-table)', function (obj) {
                var data = obj.data;
                var layEvent = obj.event;

                if (layEvent === 'del') {
                    layer.msg('删除' + data.id);
                } else if (layEvent === 'edit') {
                    layer.msg('修改' + data.id);
                }
            });
});
    </script>
</body>
</html>