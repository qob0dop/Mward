<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>生命体征数据查询</title>
    <link rel="stylesheet" href="../lib/layui-v2.6.3/css/layui.css" media="all">
    <link rel="stylesheet" href="../css/public.css" media="all">
    <style>
        .layui-btn:not(.layui-btn-lg ):not(.layui-btn-sm):not(.layui-btn-xs) {
            height: 34px;
            line-height: 34px;
            padding: 0 8px;
        }
    </style>
</head>
<body>
    <div class="layuimini-container">
        <div class="layuimini-main">
            <blockquote class="layui-elem-quote">
                生命体征数据查询<br>
            </blockquote>
            <div>
                <!--<div class="layui-btn-group">
                    <button class="layui-btn" id="btn-expand">全部展开</button>
                    <button class="layui-btn layui-btn-normal" id="btn-fold">全部折叠</button>
                    <button type="button" class="layui-btn layui-btn-primary" id="test-page-title">剔除默认标题栏</button>
                </div>-->
                <table id="munu-table" class="layui-table" lay-filter="munu-table"></table>
            </div>
        </div>
    </div>
    <!-- 操作列 -->
    <script type="text/html" id="auth-state">
        <a class="layui-btn layui-btn-normal layui-btn-xs" lay-event="view_tpr">查看体温单</a>
        <!--<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>-->
    </script>
    <script type="text/html" id="sexTpl">
        {{#  if(d.sex_name === '女'){ }}
        <span style="color: #F581B1;">{{ d.sex_name }}</span>
        {{#  } else { }}
    <span style="color: dodgerblue;">
        {{ d.sex_name }}
    </span>
            {{#  } }}
    </script>
    <script src="../lib/layui-v2.6.3/layui.js" charset="utf-8"></script>
    <script src="../js/lay-config.js?v=1.0.4" charset="utf-8"></script>
    <script>
layui.use(['table', 'treetable'], function () {
            var $ = layui.jquery;
            var table = layui.table;
            var treetable = layui.treetable;

            // 渲染表格
            var table = layui.table;

            // 渲染
            table.render({
                elem: '#munu-table',
                url: 'http://10.102.38.249:5105/api/MobileWard/GetActPatientLists?ward=' + localStorage.ward_sn + '&inout=I',
                page: true,
                response: {
                    statusCode: 1 // 重新规定成功的状态码为 1，table 组件默认为 0
                },
                // 将原始数据解析成 table 组件所规定的数据格式
                parseData: function (res) {
                    return {
                        "code": res.status, //解析接口状态
                        "msg": res.message, //解析提示文本
                        "count": res.total, //解析数据长度
                        "data": res.data //解析数据列表
                    };
                },
                cellMinWidth: 60,
                cols: [[
                    { field: 'inpatient_no', title: '住院号', fixed: 'left', sort: true, width: 100 },// unresize: true,
                    { field: 'bed_no', title: '床号', sort: true, width: 80 },
                    { field: 'patient_id', title: 'id', hide: true },
                    { field: 'admiss_times', title: 'admiss_times', hide: true },
                    { field: 'name', title: '姓名' },
                    { field: 'sex_name', title: '性别', width: 60, templet: '#sexTpl' },
                    { field: 'ages', title: '年龄', width: 100 },
                    { field: 'admiss_date', title: '入院时间' },

                    { fixed: 'right', title: '操作', toolbar: '#auth-state' }
                    //{field:'responce_type_name', title:'身份'},
                    //{field:'refer_physician_name', title:'管床医生'},
                    //{field:'refer_nurse_name', title:'管床护士'},
                    //{field:'admiss_status_name', title:'状态'},
                    //{field:'nursing', title:'护理级别'}
                ]],
                //height: 315

            });

            $('#btn-expand').click(function () {
                treetable.expandAll('#munu-table');
            });

            $('#btn-fold').click(function () {
                treetable.foldAll('#munu-table');
            });

            //监听工具条
            table.on('tool(munu-table)', function (obj) {
                var data = obj.data;
                var layEvent = obj.event;

                if (layEvent === 'del') {
                    layer.msg('删除' + data.id);
                } else if (layEvent === 'edit') {
                    layer.msg('修改' + data.id);
                } else if (layEvent === 'view_tpr') {

                    //layer.msg("id:"+ data.patient_id);
                    //layer.msg("admiss_times:"+ data.admiss_times);
                    window.parent.layui.layer.open({
                        type: 2,
                        area: ['100%', '100%'],
                        title: "体温单",
                        closeBtn: 1,
                        shadeClose: true, // 点击遮罩关闭层
                        content: 'http://10.102.38.249:8001/?patient_id=' + data.patient_id + '&admiss_times=' + data.admiss_times + '&api_host=http://localhost:5105/' //这里content是一个URL，如果你不想让iframe出现滚动条，你还可以content: ['http://sentsin.com', 'no']
                    });
                }
            });
});
    </script>
</body>
</html>